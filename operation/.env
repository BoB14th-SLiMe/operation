# ============================================
# OT Security Monitoring System - Environment Variables
# ============================================

# ============================================
# 1. Elasticsearch Configuration (Dashboard PC)
# ============================================
ELASTICSEARCH_HOST=100.126.141.58
ELASTICSEARCH_PORT=9200
ELASTICSEARCH_USERNAME=
ELASTICSEARCH_PASSWORD=
ELASTICSEARCH_INDEX_PREFIX=ics-packets
ELASTICSEARCH_USE_HTTPS=false

# ============================================
# 2. Redis Configuration (Local - Docker)
# ============================================
# 🔥 Parser는 host 네트워크를 사용하므로 localhost로 접근
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_POOL_SIZE=8
REDIS_ASYNC_WRITERS=2
REDIS_ASYNC_QUEUE_SIZE=10000
REDIS_TIMEOUT_MS=1000
REDIS_STREAM_MAX_LEN=100000
REDIS_ASSET_CACHE_TTL=3600
REDIS_MEMORY_LIMIT=512M

# ============================================
# 3. Parser Configuration
# ============================================
# 네트워크 인터페이스 (veth1, eth0, any 등)
# 주의: veth1@veth0 형태로 표시되는 경우 veth1만 사용
NETWORK_INTERFACE=veth1

# BPF 필터 (예: "tcp port 502" - 선택사항)
BPF_FILTER=

# Parser 모드
# - realtime: 실시간 스트리밍 (파일 출력 없음)
# - with-files: 파일 출력 포함
PARSER_MODE=realtime

# 파일 롤링 간격 (분 단위, 0 = 무제한)
ROLLING_INTERVAL=0

# 출력 디렉토리
OUTPUT_DIR=/data/output

# Worker 스레드 수 (0 = 자동)
PARSER_THREADS=0

# ============================================
# 4. Elasticsearch Bulk Settings
# ============================================
# Bulk 요청당 문서 수
ES_BULK_SIZE=100

# Bulk flush 간격 (밀리초)
ES_BULK_FLUSH_INTERVAL_MS=100

# ============================================
# 5. Logging
# ============================================
LOG_LEVEL=INFO

# ============================================
# 6. Resource Limits
# ============================================
PARSER_MEMORY_LIMIT=2g
PARSER_CPU_LIMIT=2.0